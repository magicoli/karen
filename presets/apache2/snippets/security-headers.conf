# Security headers snippet for Apache
# Usage: IncludeOptional /etc/apache2/snippets/security-headers.conf

<IfModule mod_headers.c>
  # Remove server info
  Header unset Server
  Header always unset X-Powered-By
  
  # Security headers
  Header always set X-Content-Type-Options "nosniff"
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Permissions-Policy "camera=(), microphone=(), geolocation=()"
  
  # Performance timing header (using mod_unique_id if available)
  <IfModule mod_unique_id.c>
    Header always set X-Response-Time "%D"
  </IfModule>
  
  # Content Security Policy (basic - should be customized per site)
  # Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'"
</IfModule>

# Additional security measures
<IfModule mod_rewrite.c>
  # Block access to sensitive files
  RewriteEngine On
  RewriteRule ^(.*/)?\.git/ - [F,L]
  RewriteRule ^(.*/)?\.env$ - [F,L]
  RewriteRule ^(.*/)?composer\.(json|lock)$ - [F,L]
  RewriteRule ^(.*/)?package(-lock)?\.json$ - [F,L]
</IfModule>
