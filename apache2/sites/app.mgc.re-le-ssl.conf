<IfModule mod_ssl.c>
<VirtualHost *:443>
  <ifmodule mpm_itk_module>
    AssignUserID magic magic
  </ifmodule>
  <ifmodule suexec_module>
    SuexecUserGroup magic magic
  </ifmodule>
  ServerName app.mgc.re
  
  DocumentRoot /home/magic/domains/mgc.re/app
  ErrorLog /var/log/apache2/app.mgc.re.error.log
  CustomLog /var/log/apache2/app.mgc.re.access.log combined

# DirectoryIndex index.html index.htm index.php /lib/wrap/wrap.php

  <Directory /home/magic/domains/mgc.re/app>
    <IfVersion < 2.3>
      Order allow,deny
      Allow from all
    </IfVersion>
    <IfVersion >= 2.3>
      Require all granted
    </IfVersion>

    Options -Indexes +Includes +IncludesNOEXEC +SymLinksIfOwnerMatch
    AllowOverride All
#   # http://www.vincentliefooghe.net/content/virtualhost-apache-pour-drupal
#     AllowOverride none
#     Include /home/magic/domains/mgc.re/app/.htaccess
#     Include /home/magic/domains/mgc.re/app/sites/default/files/.htaccess
  </Directory>
  <Directory /home/magic/domains/mgc.re/tmp/app>
    AllowOverride All
  </Directory>

  php_admin_value open_basedir "/opt/magic/lib:/usr/share:/var/lib:/var/tmp:/home/magic/domains/app.mgc.re:."
  php_admin_value upload_tmp_dir "/home/magic/domains/mgc.re/tmp/app"
  php_admin_value session.save_path "/home/magic/domains/mgc.re/tmp/app"
  php_admin_value max_input_vars 1000
  php_admin_value memory_limit 256M
  php_value max_execution_time 60
#  php_admin_value sendmail_path "/usr/sbin/sendmail -t -i -f webmaster@app.mgc.re"
#  php_admin_value upload_max_filesize "100M"
#  php_value post_max_size "100M"

#  RewriteEngine on
#  RewriteCond %{HTTP_HOST} !^www.app.mgc.re$
#  RewriteRule ^(.*) http://www.app.mgc.re$1          [R]

#  SSLEngine on
#  SSLCertificateFile /home/magic/domains/app.mgc.re/etc/app.mgc.re.crt 
#  SSLCertificateKeyFile /home/magic/domains/app.mgc.re/etc/app.mgc.re.key 
#  SSLCertificateChainFile /etc/ssl/startssl/sub.class1.server.ca.pem

Include /etc/letsencrypt/options-ssl-apache.conf
SSLCertificateFile /etc/letsencrypt/live/app.mgc.re/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/app.mgc.re/privkey.pem
</VirtualHost>
</IfModule>
