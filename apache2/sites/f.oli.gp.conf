<VirtualHost *:80>
  <ifmodule mpm_itk_module>
    AssignUserID magic magic
  </ifmodule>
  <ifmodule suexec_module>
    SuexecUserGroup magic magic
  </ifmodule>
  ServerName f.oli.gp
  ServerAlias amis.oli.gp
  ServerAlias mas.oli.gp

  DocumentRoot /home/magic/domains/f.oli.gp/www
  ErrorLog /var/log/apache2/f.oli.gp.error.log
  CustomLog /var/log/apache2/f.oli.gp.access.log combined

# DirectoryIndex index.html index.htm index.php /lib/wrap/wrap.php

  <Directory /home/magic/domains/f.oli.gp/www>
    <IfVersion < 2.3>
      Order allow,deny
      Allow from all
    </IfVersion>
    <IfVersion >= 2.3>
      Require all granted
    </IfVersion>
    Options -Indexes +Includes +IncludesNOEXEC +SymLinksIfOwnerMatch
    AllowOverride All
  </Directory>

  <Directory /home/magic/domains/f.oli.gp/tmp/www>
    AllowOverride All
  </Directory>

  php_admin_value open_basedir "/opt/magic/lib:/usr/share:/var/lib:/var/tmp:/home/magic/domains/f.oli.gp:."
  php_admin_value upload_tmp_dir "/home/magic/domains/f.oli.gp/tmp/www"
  php_admin_value session.save_path "/home/magic/domains/f.oli.gp/tmp/www"
  php_value memory_limit 256M
  php_value max_input_vars 2000
  php_value max_execution_time 60
  # php_value upload_max_filesize "100M"
  # php_value post_max_size "100M"
  # php_value sendmail_path "/usr/sbin/sendmail -t -i -f webmaster@f.oli.gp"

  # RewriteEngine on
  # RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]

RewriteEngine on
RewriteCond %{SERVER_NAME} =mas.oli.gp [OR]
RewriteCond %{SERVER_NAME} =f.oli.gp [OR]
RewriteCond %{SERVER_NAME} =amis.oli.gp
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
