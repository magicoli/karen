# gites-mosaiques.com - Clean semantic Apache configuration
# Pure include-based approach with variables

# HTTP to HTTPS redirect
<VirtualHost *:80>
  # Primary server configuration
  ServerName gites-mosaiques.com
  ServerAlias www.gites-mosaiques.com
  ServerAlias dev.gites-mosaiques.com
  
  # Site variables (for includes and templates)
  Define SITE_DOMAIN gites-mosaiques.com
  Define SITE_ROOT /home/mosaiques/domains/gites-mosaiques.com/www
  Define SITE_USER mosaiques
  
  # Use variables in config
  DocumentRoot ${SITE_ROOT}
  
  # Directory settings
  <Directory ${SITE_ROOT}>
    Require all granted
    AllowOverride All
    Options -Indexes +FollowSymLinks -MultiViews
  </Directory>

  # SSL configuration
  # Include snippets/ssl-engine.conf

  # Core functionality includes
  Include snippets/security-headers.conf
  Include snippets/static-files.conf
  Include snippets/logging.conf
  
  # # Application type: WordPress
  Include snippets/wordpress.conf
  
  # # Optional features
  IncludeOptional snippets/enhanced-logging.conf
  IncludeOptional snippets/php-monitoring.conf
  
  # Site-specific overrides go here
  # ErrorDocument 404 /404.php
  
  # Let's not care yet about the redirect
  # RewriteEngine On
  # RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

# Main HTTPS site
<VirtualHost *:443>
  ServerName gites-mosaiques.com
  ServerAlias www.gites-mosaiques.com
  ServerAlias dev.gites-mosaiques.com
  
  # Site variables (used by includes)
  Define SITE_DOMAIN gites-mosaiques.com
  Define SITE_ROOT /home/mosaiques/domains/gites-mosaiques.com/www
  Define SITE_USER mosaiques
  
  # Use variables in config
  DocumentRoot ${SITE_ROOT}
  
  # Directory settings
  <Directory ${SITE_ROOT}>
    Require all granted
    AllowOverride All
    Options -Indexes +FollowSymLinks -MultiViews
  </Directory>

  # SSL configuration
  Include snippets/ssl-engine.conf

  # Core functionality includes
  Include snippets/security-headers.conf
  Include snippets/static-files.conf
  Include snippets/logging.conf
  
  # Application type: WordPress
  Include snippets/wordpress.conf
  
  # Optional features
  IncludeOptional snippets/enhanced-logging.conf
  IncludeOptional snippets/php-monitoring.conf
  
  # Site-specific overrides go here
  # ErrorDocument 404 /404.php
</VirtualHost>

# # Examples of different configurations:
# #
# # Multiple domains:
# # Use WordPress mysite example.org /path/to/docroot "example.com www.example.com example.info www.example.info"  
# #
# # WordPress in subfolder:
# # Use WordPress mysite example.org /path/to/docroot wp/
# #
# # Nextcloud in subfolder:
# # Use Nextcloud mysite example.org /path/to/docroot cloud/
# #
# # Webmail in subfolder:
# # Use Webmail mysite example.org /path/to/docroot mail/
