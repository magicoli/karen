<VirtualHost *:80>
  <ifmodule mpm_itk_module>
    AssignUserID magic magic
  </ifmodule>
  <ifmodule suexec_module>
    SuexecUserGroup magic magic
  </ifmodule>
  ServerName watta.world
  ServerAlias www.watta.world
  ServerAlias *.watta.world

  DocumentRoot /home/magic/domains/watta.world/www
  ErrorLog /var/log/apache2/watta.world.error.log
  CustomLog /var/log/apache2/watta.world.access.log combined

# DirectoryIndex index.html index.htm index.php /lib/wrap/wrap.php

  <Directory /home/magic/domains/watta.world/www>
    <IfVersion < 2.3>
      Order allow,deny
      Allow from all
    </IfVersion>
    <IfVersion >= 2.3>
      Require all granted
    </IfVersion>
    Options -Indexes +Includes +IncludesNOEXEC +SymLinksIfOwnerMatch
    AllowOverride All
  </Directory>

  <Directory /home/magic/domains/watta.world/tmp/www/www>
    AllowOverride All
  </Directory>

  php_admin_value open_basedir "/opt/magic/lib:/usr/share:/var/lib:/var/tmp:/home/magic/domains/watta.world:."
  php_admin_value upload_tmp_dir "/home/magic/domains/watta.world/tmp/www/www"
  php_admin_value session.save_path "/home/magic/domains/watta.world/tmp/www/www"
  php_value memory_limit 256M
  php_value max_input_vars 2000
  php_value max_execution_time 60
  # php_value upload_max_filesize "100M"
  # php_value post_max_size "100M"
  # php_value sendmail_path "/usr/sbin/sendmail -t -i -f webmaster@watta.world"

  # RewriteEngine on
  # RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]

RewriteEngine on
RewriteCond %{SERVER_NAME} =*.watta.world [OR]
RewriteCond %{SERVER_NAME} =www.watta.world [OR]
RewriteCond %{SERVER_NAME} =watta.world
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>
